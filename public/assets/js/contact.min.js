/******/ (() => { // webpackBootstrap
var __webpack_exports__ = {};
/*!****************************************!*\
  !*** ./resources/assets/js/contact.js ***!
  \****************************************/
var contactsurl = $("#url").val();
var totalPage = 0;
var customLimit = 5;
var lastUserId;
$(document).ready(function () {
  getcontacts();
});
$("#contact_form").submit(function (event) {
  $("#contact_add").prop('disabled', true);
  event.preventDefault();
  var formData = new FormData(this);
  ajaxRequest('POST', "".concat(contactsurl, "/user/contact/add"), formData, false, false, function (result) {
    if (result.flag === 1) {
      $('#contact_form')[0].reset();
      getcontacts();
      showToast(result.msg, 'success');
      $('#addModal').modal('hide');
      $("#contact_add").prop('disabled', false);
    } else {
      showToast(result.msg, 'danger');
      $("#contact_add").prop('disabled', false);
    }
  });
});
$(document).on("click", ".updateBtn", function () {
  lastUserId = $(this).data("id");
  var contact_name = $(this).data("name");
  var contact_email = $(this).data("email");
  var contact_number = $(this).data("number");
  var contact_image = $(this).data("image");
  var contact_group = $(this).data("group");
  $("#update_form input[name='name']").val(contact_name);
  $("#update_form input[name='email']").val(contact_email);
  $("#update_form input[name='number']").val(contact_number);
  $("#update_form input[name='image']").val(contact_image);
  $("#update_form select[name='group']").val(contact_group);
});
$("#contact_update_btn").click(function () {
  $('#contact_update_btn').prop('disabled', true);
  var formData = new FormData($("#update_form")[0]);
  if (lastUserId) {
    ajaxRequest('PATCH', "".concat(contactsurl, "/user/contact/update/").concat(lastUserId), formData, false, false, function (result) {
      if (result.flag === 1) {
        $("#update_form")[0].reset();
        getcontacts();
        showToast(result.msg, 'success');
        $("#updateModal").modal("hide");
        $('#contact_update_btn').prop('disabled', false);
      } else {
        showToast(result.msg, 'danger');
        $('#contact_update_btn').prop('disabled', false);
      }
    });
  }
  ;
});
$(document).on("click", ".deleteBtn", function () {
  lastUserId = $(this).data("id");
});
$("#delete_contact_btn").click(function () {
  if (lastUserId) {
    ajaxRequest('DELETE', "".concat(contactsurl, "/user/contact/delete/").concat(lastUserId), null, false, false, function (result) {
      if (result.flag === 1) {
        getcontacts();
        showToast(result.msg, 'success');
        $('#deleteModal').modal('hide');
      } else {
        showToast(result.msg, 'danger');
      }
    });
    lastUserId = null;
  }
});
$('body').on('click', '[id^="page_"]', function () {
  var page = parseInt($(this).data('page'));
  var searchData = getSearchData();
  getcontacts(page, customLimit, searchData);
});
$('body').on('click', '#prev_page', function () {
  var currentPage = parseInt($('.pagination-lg li.active a').text());
  var prevPage = currentPage - 1;
  var searchData = getSearchData();
  if (currentPage > 1) {
    getcontacts(prevPage, customLimit, searchData);
  }
});
$('body').on('click', '#next_page', function () {
  var currentPage = parseInt($('.pagination-lg li.active a').text());
  var nextPage = currentPage + 1;
  var searchData = getSearchData();
  if (nextPage <= totalPage) {
    getcontacts(nextPage, customLimit, searchData);
  }
});
$(document).on('submit', '#contact_limit_form', function (event) {
  event.preventDefault();
  var limitInput = $("#contact_limit").val();
  if (limitInput.length > 3) {
    showToast('Input value cannot exceed 3 digits', 'danger');
  } else {
    customLimit = limitInput || 5;
    var searchData = getSearchData();
    getcontacts(1, customLimit, searchData);
  }
});
var getSearchData = function getSearchData() {
  return {
    name: $('#search_name').val().trim(),
    email: $('#search_email').val().trim(),
    number: $('#search_number').val().trim(),
    group: $('#search_group').val().trim()
  };
};
$(document).on('submit', '#search_form', function (event) {
  event.preventDefault();
  var searchData = getSearchData();
  if (Object.values(searchData).some(function (value) {
    return value !== '';
  })) {
    getcontacts(1, customLimit, searchData);
  } else {
    $(this)[0].reset();
    showToast('Please enter at least one search field', 'danger');
  }
});
$(document).on('click', "#reset_btn", function () {
  $("#search_form")[0].reset();
  getcontacts(1, customLimit, '', '', '', '');
});
var getcontacts = function getcontacts() {
  var page = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;
  var limit = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : customLimit;
  var searchData = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};
  var FormData = {
    page: page,
    limit: limit,
    search_name: searchData.name,
    search_email: searchData.email,
    search_number: searchData.number,
    search_group: searchData.group
  };
  ajaxRequest('POST', "".concat(contactsurl, "/user/contact/list"), FormData, 'application/x-www-form-urlencoded', true, function (result) {
    if (result.flag === 1) {
      var response = result.data.views;
      $('#contact_list').html(response);
      totalPage = result.data.totalPage;
    }
  });
};
ajaxRequest('POST', "".concat(contactsurl, "/user/contact/group"), null, false, false, function (result) {
  if (result.flag == 1) {
    var group = result.data;
    var groupName = group.map(function (group, index) {
      var groupID = "group_selected_".concat(index);
      return "<option class=\"selectedOption\" id=\"".concat(groupID, "\" data-id=\"").concat(groupID, "\" value=\"").concat(group._id, "\">").concat(group.name, "</option>");
    });
    var groupNameDefault = "<option value=\"\">Select Group</option>".concat(groupName.join(''));
    $('#add_group, #update_group, #search_group').html(groupNameDefault);
  }
  ;
});
/******/ })()
;